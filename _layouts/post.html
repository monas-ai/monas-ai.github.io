---
layout: default
script_includes:
  - comment
---

{% include lang.html %}

{% include toc-status.html %}

{% assign words = content | strip_html | number_of_words: 'auto' %}
{% assign wpm = 180 %}
{% assign read_time = words | divided_by: wpm %}
{% unless read_time > 0 %}{% assign read_time = 1 %}{% endunless %}

{% assign content_type = page.content_type | default: page.type %}
{% unless content_type %}
  {% assign first_cat = page.categories | first | downcase %}
  {% if first_cat contains 'news' %}
    {% assign content_type = 'news' %}
  {% elsif first_cat contains 'guide' %}
    {% assign content_type = 'guide' %}
  {% elsif first_cat contains 'change' or first_cat contains 'note' %}
    {% assign content_type = 'changelog' %}
  {% else %}
    {% assign content_type = 'deep-dive' %}
  {% endif %}
{% endunless %}

<div id="reading-progress" aria-hidden="true"></div>

<div class="site-container">
<article class="post" data-toc="{{ enable_toc }}" data-post-slug="{{ page.slug }}" data-post-category="{{ page.categories | first }}" data-post-tags="{{ page.tags | join: ',' }}" data-content-type="{{ content_type }}" data-reading-time="{{ read_time }}">
  <header class="post-hero">
    <nav class="breadcrumb">
      <a href="{{ '/' | relative_url }}">Home</a>
      {% if page.categories.size > 0 %}
        <span>/</span>
        <a href="{{ site.baseurl }}/categories/{{ page.categories | first | slugify | url_encode }}/">
          {{ page.categories | first }}
        </a>
      {% endif %}
      <span>/</span>
      <span>{{ page.title }}</span>
    </nav>

    <p class="eyebrow">{{ content_type | replace: '-', ' ' }}</p>
    <h1>{{ page.title }}</h1>

    {% if page.description %}
      <p class="post-desc">{{ page.description }}</p>
    {% endif %}

    <div class="post-meta">
      <span class="meta-item">
        {{ site.data.locales[lang].post.posted }}
        {% include datetime.html date=page.date tooltip=true lang=lang %}
      </span>

      {% if page.last_modified_at and page.last_modified_at != page.date %}
        <span class="meta-item">
          {{ site.data.locales[lang].post.updated }}
          {% include datetime.html date=page.last_modified_at tooltip=true lang=lang %}
        </span>
      {% endif %}

      <span class="meta-item">{{ read_time }} {{ site.data.locales[lang].post.read_time.unit }}</span>
      <span class="meta-item">{{ words }} {{ site.data.locales[lang].post.words }}</span>
    </div>

    {% if page.tags.size > 0 %}
      <div class="chip-row post-tags">
        {% for tag in page.tags %}
          <a class="chip" href="{{ site.baseurl }}/tags/{{ tag | slugify | url_encode }}/">{{ tag }}</a>
        {% endfor %}
      </div>
    {% endif %}

    {% if page.image %}
      {% capture src %}{{ page.image.path | default: page.image }}{% endcapture %}
      {% capture alt %}{{ page.image.alt | xml_escape | default: "Preview Image" }}{% endcapture %}
      {% capture img_url %}{% include media-url.html src=src subpath=page.media_subpath %}{% endcapture %}
      <figure class="post-hero-media">
        <img src="{{ img_url }}" alt="{{ alt }}">
        {% if page.image.alt %}
          <figcaption>{{ page.image.alt }}</figcaption>
        {% endif %}
      </figure>
    {% endif %}
  </header>

  {% if enable_toc %}
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">{{ page.title }}</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">{{- site.data.locales[lang].panel.toc -}}</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">{{- page.title -}}</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  {% endif %}

  <div class="post-layout has-rail">
    <div class="post-content">
      <div class="content">
        {% include refactor-content.html content=content lang=lang %}
      </div>

      {% if page.takeaways %}
        <section class="key-takeaways">
          <h2>Key takeaways</h2>
          <ul>
            {% for item in page.takeaways %}
              <li>{{ item }}</li>
            {% endfor %}
          </ul>
        </section>
      {% endif %}

      {% if page.categories.size > 0 %}
        <div class="post-meta post-categories">
          <span class="meta-label">Category</span>
          {% for category in page.categories %}
            <a class="chip" href="{{ site.baseurl }}/categories/{{ category | slugify | url_encode }}/">{{ category }}</a>
          {% endfor %}
        </div>
      {% endif %}

      {% include related-posts.html %}
      {% include post-nav.html %}
    </div>

    {% include post-widgets.html lang=lang %}
  </div>

  {% include floating-actions.html lang=lang %}
</article>
</div>
